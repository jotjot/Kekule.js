{"version":3,"file":"render.min.js","sources":["../src/render.js"],"sourcesContent":["define(/*'qtype_kekule_chem_base/render',*/ ['kekule'], function(){\r\n\r\nfunction init() {\r\n\r\n\tfunction findPlaceHolders() {\r\n\t\tvar result = [];\r\n\t\tvar elems = document.getElementsByTagName('span');\r\n\t\tfor (var i = 0, l = elems.length; i < l; ++i) {\r\n\t\t\tvar className = elems[i].className;\r\n\t\t\tif (className && className.indexOf('K-Chem-Question-Blank') >= 0)  // is a place holder\r\n\t\t\t{\r\n\t\t\t\tresult.push(elems[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tfunction createChemWidgets(placeHolderElems) {\r\n\t\tfor (var i = 0, l = placeHolderElems.length; i < l; ++i) {\r\n\t\t\tvar placeHolder = placeHolderElems[i];\r\n\t\t\t//var molData = placeHolder.value;\r\n\t\t\tvar className = placeHolder.getAttribute('data-widget-class');\r\n\t\t\tvar widgetType = placeHolder.getAttribute('data-preferWidget');\r\n\t\t\tvar ctrlName = placeHolder.getAttribute('data-name');\r\n\t\t\tvar inputType = placeHolder.getAttribute('data-input-type');\r\n\t\t\tcreateChemWidget(placeHolder, ctrlName, className, widgetType, inputType);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction createChemWidget(placeHolder, ansCtrlName, className, widgetType, inputType) {\r\n\t\tvar N = Kekule.ChemWidget.ComponentWidgetNames;\r\n\t\tvar widgetClass, widgetProps;\r\n\t\tif (widgetType === 'composer') {\r\n\t\t\twidgetClass = Kekule.Editor.Composer;\r\n\t\t\twidgetProps = {\r\n\t\t\t\tresizable: true\r\n\t\t\t};\r\n\r\n\t\t\tif (inputType === 'doc')  // allow input document\r\n\t\t\t{\r\n\t\t\t\twidgetProps.predefinedSetting = 'fullFunc';\r\n\t\t\t} else  // molecule\r\n\t\t\t{\r\n\t\t\t\twidgetProps.predefinedSetting = 'molOnly';\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\twidgetClass = Kekule.ChemWidget.Viewer;\r\n\t\t\twidgetProps = {\r\n\t\t\t\t//predefinedSetting: 'editOnly',\r\n\t\t\t\t//resizable: true,\r\n\t\t\t\tautoSize: true,\r\n\t\t\t\tenableEditFromVoid: true\r\n\t\t\t};\r\n\r\n\t\t\tif (inputType === 'doc')  // allow input document\r\n\t\t\t{\r\n\t\t\t\twidgetProps.restrainEditorWithCurrObj = false;\r\n\t\t\t\twidgetProps.editorProperties = {\r\n\t\t\t\t\t'predefinedSetting': 'molOnly',\r\n\t\t\t\t\t'allowCreateNewChild': true\r\n\t\t\t\t};\r\n\t\t\t} else  // molecule\r\n\t\t\t{\r\n\t\t\t\twidgetProps.restrainEditorWithCurrObj = true;\r\n\t\t\t\twidgetProps.editorProperties = {\r\n\t\t\t\t\t'predefinedSetting': 'molOnly',\r\n\t\t\t\t\t'allowCreateNewChild': false\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\twidgetProps.editorProperties.minDimension = {'width': 450, height: 350};\r\n\t\t\t/*\r\n\t\t\twidgetProps.editorProperties.commonToolButtons = [\r\n\t\t\t\tN.newDoc,\r\n\t\t\t\tN.loadData,\r\n\t\t\t\tN.saveData,\r\n\t\t\t\tN.undo,\r\n\t\t\t\tN.redo,\r\n\t\t\t\tN.zoomIn,\r\n\t\t\t\tN.zoomOut\r\n\t\t\t];\r\n\t\t\t*/\r\n\t\t}\r\n\r\n\t\tvar ctrlElem = getBlankRelatedElems(ansCtrlName).answer;\r\n\r\n\t\tvar isEmpty = !ctrlElem;\r\n\t\tvar jsonObj = null;\r\n\t\tif (ctrlElem) {\r\n\t\t\t// hide ctrlElem\r\n\t\t\thideElem(ctrlElem);\r\n\t\t\t// get answer value from ctrlElem\r\n\t\t\tvar ansValue = ctrlElem.value;\r\n\t\t\tif (ansValue) {\r\n\t\t\t\t//console.log(ansValue);\r\n\t\t\t\tjsonObj = parseAnswerString(ansValue);\r\n\t\t\t\t/*\r\n\t\t\t\tif (jsonObj && jsonObj.molData)\r\n\t\t\t\t{\r\n\t\t\t\t\tplaceHolder.setAttribute('data-chem-obj', jsonObj.molData);\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t\tisEmpty = true;\r\n\t\t\t\t*/\r\n\t\t\t}\r\n\t\t\tif (!jsonObj || !jsonObj.molData)\r\n\t\t\t\tisEmpty = true;\r\n\t\t}\r\n\r\n\t\tvar result = new widgetClass(placeHolder);\r\n\t\tresult.addClassName(className);\r\n\t\tresult.__answerElem__ = ctrlElem;\r\n\t\tif (widgetProps)\r\n\t\t\tresult.setPropValues(widgetProps);\r\n\r\n\t\tif (!isEmpty)  // load chem object\r\n\t\t{\r\n\t\t\tvar molData = jsonObj.molData;\r\n\t\t\tvar dataType = jsonObj.molDataType || Kekule.IO.MimeType.KEKULE_JSON;\r\n\t\t\ttry {\r\n\t\t\t\tvar chemObj = Kekule.IO.loadMimeData(molData, dataType);\r\n\t\t\t\tif (chemObj)\r\n\t\t\t\t\tresult.setChemObj(chemObj);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(e);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (widgetClass === Kekule.ChemWidget.Viewer) {\r\n\t\t\t// add copy structure button\r\n\t\t\tresult.setToolButtons([{\r\n\t\t\t\t'widgetClass': Kekule.Widget.DropDownButton,\r\n\t\t\t\t'htmlClass': 'KM-Btn-Copy-Structure',\r\n\t\t\t\t'text': Kekule.$L('KekuleMoodleTexts.CAPTION_COPY_QUESTION_STRUCTURE'),\r\n\t\t\t\t'hint': Kekule.$L('KekuleMoodleTexts.HINT_COPY_QUESTION_STRUCTURE'),\r\n\t\t\t\t'dropDownWidgetGetter': _btnStructureCopyDropDownPanelGetter,\r\n\t\t\t\t'#dropDown': _reactBtnCopyStructureDropdown\r\n\t\t\t},\r\n\t\t\t\tKekule.ChemWidget.ComponentWidgetNames.openEditor]);\r\n\t\t}\r\n\r\n\t\t// TODO: now only handle viewer event\r\n\t\tif (widgetClass === Kekule.ChemWidget.Viewer) {\r\n\t\t\tresult.on('load', reactViewerChemObjLoad);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tfunction reactViewerChemObjLoad(e) {\r\n\t\tvar viewer = e.currentTarget || e.target;\r\n\t\tif (viewer instanceof Kekule.ChemWidget.Viewer)  // avoid event invoked by composer\r\n\t\t{\r\n\t\t\tvar ansElem = viewer.__answerElem__;\r\n\t\t\tif (ansElem) {\r\n\t\t\t\tvar sAnswer = '';\r\n\t\t\t\tvar molData = '', smiles = '', smilesNoStereo = '';\r\n\t\t\t\tvar chemObj = viewer.getChemObj();\r\n\t\t\t\tif (chemObj) {\r\n\t\t\t\t\tif ((chemObj.isEmpty && chemObj.isEmpty()) || ((chemObj instanceof Kekule.ChemDocument) && (chemObj.getChildCount() <= 0)))  // a empty chem object/document\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsAnswer = '';\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tmolData = Kekule.IO.saveMimeData(chemObj, Kekule.IO.MimeType.KEKULE_JSON);\r\n\t\t\t\t\t\t\tsmiles = Kekule.IO.saveMimeData(chemObj, Kekule.IO.MimeType.SMILES, {'ignoreStereo': false});\r\n\t\t\t\t\t\t\tsmilesNoStereo = Kekule.IO.saveMimeData(chemObj, Kekule.IO.MimeType.SMILES, {'ignoreStereo': true});\r\n\t\t\t\t\t\t} catch (e) {\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar saveObj = {\r\n\t\t\t\t\t\t\t'smiles': smiles || '',\r\n\t\t\t\t\t\t\t'smilesNoStereo': smilesNoStereo || '',\r\n\t\t\t\t\t\t\t'molData': molData || ''\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tsAnswer = JSON.stringify(saveObj);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tansElem.value = sAnswer;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction _btnStructureCopyDropDownPanelGetter(btn) {\r\n\t\tvar doc = btn.getDocument();\r\n\t\t/*\r\n\t\tvar result = new Kekule.Widget.Panel(doc);\r\n\t\tvar grid = new Kekule.ChemWidget.ViewerGrid2D(result);\r\n\t\tresult._grid = grid;\r\n\t\tresult._parentViewer = btn.getParent().getParent(); // mark\r\n\t\t*/\r\n\t\tvar result = new KekuleMoodle.Widget.ChemObjSelectorPanel(doc);\r\n\t\tresult._questionElem = getQuestionRootElem(btn.getParent().getParent().getElement());\r\n\t\tresult.setCaption(Kekule.$L('KekuleMoodleTexts.CAPTION_COPY_QUESTION_STRUCTURE'));\r\n\t\tresult.on('select', _reactStructureCopyDropDownPanelSelect);\r\n\t\t_refreshMoleculesInDropdownPanel(btn, result);\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tfunction _reactStructureCopyDropDownPanelSelect(e) {\r\n\t\tvar panel = e.target;\r\n\t\t//console.log(panel._invokerViewer, e.chemObj);\r\n\t\tvar mol = e.chemObj;\r\n\t\tif (mol && mol instanceof Kekule.StructureFragment) {\r\n\t\t\tvar viewer = panel._invokerViewer;\r\n\t\t\tviewer.setChemObj(mol.clone());\r\n\t\t}\r\n\t}\r\n\r\n\tfunction _refreshMoleculesInDropdownPanel(btn, panel) {\r\n\t\t//var grid = panel._grid;\r\n\t\tvar molecules = [];\r\n\t\tvar viewerBlank = btn.getParent().getParent();\r\n\t\t//var viewerBlank = panel._parentViewer;\r\n\t\tvar viewerBlankElem = viewerBlank.getElement();\r\n\t\tvar questionRootElem = getQuestionRootElem(viewerBlankElem);\r\n\t\tvar viewersInQuestion = getViewerWidgetsInsideElem(questionRootElem);\r\n\t\tif (viewersInQuestion) {\r\n\t\t\tKekule.ArrayUtils.remove(viewersInQuestion, viewerBlank);  // filter out viewers in question content\r\n\t\t\tmolecules = molecules.concat(getExistedMoleculesInViewers(viewersInQuestion));\r\n\t\t}\r\n\t\t// some <img> elements may has not been created into viewer\r\n\t\tvar proxyElems = getViewerProxiesInsideElem(questionRootElem) || [];\r\n\t\tfor (var i = 0, l = proxyElems.length; i < l; ++i) {\r\n\t\t\tvar proxy = proxyElems[i];\r\n\t\t\tvar data = proxy.getAttribute('data-chem-obj');\r\n\t\t\tif (data) {\r\n\t\t\t\t//try\r\n\t\t\t\t{\r\n\t\t\t\t\tvar json = JSON.parse(data);\r\n\t\t\t\t\tvar serializer = Class.ObjSerializerFactory.getSerializer('json');\r\n\t\t\t\t\tvar chemObj = serializer.load(null, json)\r\n\t\t\t\t\tif (chemObj) {\r\n\t\t\t\t\t\tmolecules = molecules.concat(getMoleculesInChemObj(chemObj));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t//catch(e)\r\n\t\t\t\t{\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//console.log(molecules);\r\n\t\t/*\r\n\t\tgrid.clearWidgets();\r\n\t\tfor (var i = 0, l = molecules.length; i < l; ++i)\r\n\t\t{\r\n\t\t\tgrid.addChemObj(molecules[i]);\r\n\t\t}\r\n\t\t*/\r\n\t\tpanel.setObjects(molecules);\r\n\t}\r\n\r\n\tfunction _reactBtnCopyStructureDropdown(e) {\r\n\t\t//console.log('execute');\r\n\t\tvar btn = e.target;\r\n\t\tvar panel = btn.getDropDownWidget();\r\n\t\tpanel._invokerViewer = btn.getParent().getParent();\r\n\t\t//var parentViewer = btn.getParent().getParent();\r\n\t\tvar questionElem = getQuestionRootElem(btn.getParent().getParent().getElement());\r\n\t\tif (questionElem !== panel._questionElem) {\r\n\t\t\t//console.log('refresh');\r\n\t\t\tpanel._questionElem = questionElem;\r\n\t\t\t_refreshMoleculesInDropdownPanel(btn, panel);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction isQuestionRootElem(elem) {\r\n\t\treturn (elem.className || '').indexOf('que ') >= 0;\r\n\t}\r\n\r\n\tfunction getQuestionRootElem(childElem)  // returns the root of a question section\r\n\t{\r\n\t\tif (isQuestionRootElem(childElem))\r\n\t\t\treturn childElem;\r\n\t\telse if (childElem === childElem.ownerDocument.body)\r\n\t\t\treturn childElem;\r\n\t\telse\r\n\t\t\treturn getQuestionRootElem(childElem.parentNode);\r\n\t}\r\n\r\n\tfunction getViewerWidgetsInsideElem(elem)  // returns all viewer widgets under one element\r\n\t{\r\n\t\tvar result = [];\r\n\t\tvar widgets = Kekule.Widget.Utils.getWidgetsInsideElem(elem);\r\n\t\tfor (var i = 0, l = widgets.length; i < l; ++i) {\r\n\t\t\tif (widgets[i] instanceof Kekule.ChemWidget.Viewer)\r\n\t\t\t\tresult.push(widgets[i]);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tfunction getViewerProxiesInsideElem(elem)  // return <img> elements that has not been created into viewer\r\n\t{\r\n\t\tvar result = [];\r\n\t\tvar imgs = elem.getElementsByTagName('img');\r\n\t\tfor (var i = 0, l = imgs.length; i < l; ++i) {\r\n\t\t\tvar img = imgs[i];\r\n\t\t\tif ((img.getAttribute('data-kekule-widget') || img.getAttribute('data-widget')) === 'Kekule.ChemWidget.Viewer') {\r\n\t\t\t\tresult.push(img);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tfunction getMoleculesInChemObj(obj) {\r\n\t\tvar result = [];\r\n\t\tvar objClass = Kekule.StructureFragment;\r\n\t\tvar filter = function (child) {\r\n\t\t\treturn child && (child instanceof objClass) && (child.hasCtab && child.hasCtab());\r\n\t\t};\r\n\r\n\t\tif (obj instanceof objClass)\r\n\t\t\tresult.push(obj);\r\n\t\telse if (obj instanceof Kekule.ChemSpace) {\r\n\t\t\tvar objs = obj.filterChildren(filter, true);\r\n\t\t\tresult = result.concat(objs);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tfunction getExistedMoleculesInViewers(viewers) {\r\n\t\tvar result = [];\r\n\t\tfor (var i = 0, l = viewers.length; i < l; ++i) {\r\n\t\t\tvar viewer = viewers[i];\r\n\t\t\tvar obj = viewer.getChemObj();\r\n\t\t\tif (obj) {\r\n\t\t\t\tresult = result.concat(getMoleculesInChemObj(obj));\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tfunction getBlankRelatedElems(ctrlName) {\r\n\t\t// get response form control\r\n\t\treturn {\r\n\t\t\t'answer': document.getElementsByName(ctrlName)[0]\r\n\t\t};\r\n\t}\r\n\r\n\tfunction parseAnswerString(answer) {\r\n\t\ttry {\r\n\t\t\tvar jsonObj = JSON.parse(answer);\r\n\t\t\tif (typeof (jsonObj) !== 'object')\r\n\t\t\t\treturn {};\r\n\t\t\telse\r\n\t\t\t\treturn jsonObj;\r\n\t\t} catch (e) {\r\n\t\t\treturn {};\r\n\t\t}\r\n\t}\r\n\r\n\tfunction hideElem(elem) {\r\n\t\telem.style.display = 'none';\r\n\t}\r\n\r\n\tfunction init() {\r\n\t\t// avoid student to input unwanted pseudo atoms\r\n\t\tif (Kekule.Editor.ChemSpaceEditorConfigs && Kekule.Editor.ChemSpaceEditorConfigs.getInstance) {\r\n\t\t\tvar editorConfigs = Kekule.Editor.ChemSpaceEditorConfigs.getInstance();\r\n\t\t\teditorConfigs.getInteractionConfigs().setAllowUnknownAtomSymbol(false);\r\n\t\t}\r\n\t\t//console.log('question init');\r\n\t\tvar placeHolders = findPlaceHolders();\r\n\t\tcreateChemWidgets(placeHolders);\r\n\t}\r\n\r\n\t//console.log('prepare question init');\r\n\tKekule.X.domReady(init);\r\n\r\n}\r\n\r\nreturn {\r\n\t'init': function(){\r\n\t\t//console.log('render.js initial');\r\n\t\tKekule._ready(init);\r\n\t}\r\n};\r\n\r\n});"],"names":["define","init","createChemWidget","placeHolder","ansCtrlName","className","widgetType","inputType","widgetClass","widgetProps","Kekule","ChemWidget","ComponentWidgetNames","Editor","Composer","resizable","predefinedSetting","Viewer","autoSize","enableEditFromVoid","restrainEditorWithCurrObj","editorProperties","minDimension","height","ctrlName","ctrlElem","document","getElementsByName","answer","isEmpty","jsonObj","style","display","ansValue","value","JSON","parse","e","parseAnswerString","molData","result","addClassName","__answerElem__","setPropValues","dataType","molDataType","IO","MimeType","KEKULE_JSON","chemObj","loadMimeData","setChemObj","console","error","setToolButtons","Widget","DropDownButton","$L","_btnStructureCopyDropDownPanelGetter","_reactBtnCopyStructureDropdown","openEditor","on","reactViewerChemObjLoad","viewer","currentTarget","target","ansElem","sAnswer","smiles","smilesNoStereo","getChemObj","ChemDocument","getChildCount","saveMimeData","SMILES","saveObj","stringify","btn","doc","getDocument","KekuleMoodle","ChemObjSelectorPanel","_questionElem","getQuestionRootElem","getParent","getElement","setCaption","_reactStructureCopyDropDownPanelSelect","_refreshMoleculesInDropdownPanel","panel","mol","StructureFragment","_invokerViewer","clone","molecules","viewerBlank","questionRootElem","viewersInQuestion","elem","widgets","Utils","getWidgetsInsideElem","i","l","length","push","getViewerWidgetsInsideElem","ArrayUtils","remove","concat","viewers","obj","getMoleculesInChemObj","getExistedMoleculesInViewers","proxyElems","imgs","getElementsByTagName","img","getAttribute","getViewerProxiesInsideElem","data","json","Class","ObjSerializerFactory","getSerializer","load","setObjects","getDropDownWidget","questionElem","childElem","indexOf","ownerDocument","body","parentNode","objClass","ChemSpace","objs","filterChildren","child","hasCtab","X","domReady","ChemSpaceEditorConfigs","getInstance","getInteractionConfigs","setAllowUnknownAtomSymbol","placeHolderElems","createChemWidgets","elems","findPlaceHolders","_ready"],"mappings":"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"}